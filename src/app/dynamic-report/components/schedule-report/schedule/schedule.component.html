<span class="cls-heading mt-3" tabindex="0">{{'Scheduled report' | translate }} ({{editData?.conditionReportBasedOn || 'Request details' }})</span>
<div class="cls-toggle-container" *ngIf="appService?.isEditReport?.reportAdditionalInfo?.scheduleInfo?.cronInfo">
    <span class="cls-toggle" *ngFor="let menu of menu; let f = first; let i = index" [ngClass]="{'border-right-0': f && i != 1,'border-left-0': !f && i != 1,'active': i == 1}" (click)="selectTabMenu(menu.key)">{{ menu.name }}</span>
</div>
<div class="row mb-3">
    <div class="col-md-6">
    </div>
    <div class="col-md-6 text-right" (keydown.enter)="back()">
        <span tabindex="0" class="cls-back" (click)="back()"><em class="icon-8-expand"></em>{{'Back'| translate}}</span>
    </div>
</div>
<div class="container-fluid">
    <div class="row cls-bg">
        <div class="col-md-12 cls-schedule-continer">
            <form [formGroup]="scheduleForm">
                <div class="cls-status text-right">
                    <span class="cls-inner-head mb-2">{{'Status' | translate }} : </span>
                    <label class="cls-switches" tabindex="0" (keydown.enter)="actionPerform()">
                        <input type="checkbox" name="true" value="true" checked (click)="actionPerform()">
                        <em class="cls-switch-circle cls-round" [ngClass]="{'fn-switch-active': appService?.isEditReport?.scheduleStatus === 'scheduled'}"></em>
                    </label>
                </div>
                <div class="cls-email-box">
                    <span class="cls-inner-head mb-2">{{'Select email' | translate }}: </span>
                    <div class="input-field col-md-12 p-0">
                        <input class="form-control" type="text" id="email" autocomplete="off" formControlName="email"
                        [ngClass]="{'cls-border-error':(submitted && scheduleForm.controls.email.errors)}" (keyup)="citySearch('email','get-email-possible-values',editData.conditionReportBasedOn + '-scheduleRecipients',$event)">
                        <label class="position-label" for="email">{{'Email id' | translate }}<span class="cls-mandatory">*</span></label>
                        <span class="cls-add" tabindex="0" (keydown.enter)="addEmail()" (click)="addEmail()"><em class="icon-9-plus"></em>{{'Add' | translate}}</span>
                    </div>
                </div>
                <div class="cls-email-container" *ngIf="emailArray.length > 0" tabindex="0">
                    <span class="cls-inner-head d-block mb-2">{{'Selected email' | translate}} </span>
                    <span class="cls-mailid" *ngFor="let item of emailArray; let index = index">
                        <span class="cls-email-span"  tabindex="0">
                            {{item}}<em class="icon-12-reject" (click)="removeEmail(index)" tabindex="0" [attr.aria-label]="'remove email ' + item"></em>
                        </span>
                    </span>
                </div>
                <div class="cls-daterange">
                    <span class="cls-title">{{'Frequency (DOW)' | translate }} :</span>
                    <div class="cls-background" [ngClass]="{'cls-days-active' : frequencyCheckbox}">
                        <span tabindex="0" (keydown.enter)="selectCheckbox(data.status,index)" class="cls-label" (click)="selectCheckbox(data.status,index)" *ngFor="let data of daysList;let index = index">
                            <em class="cls-icon" [ngClass]="{'icon-2-checkbox-off': data.status == 'N','icon-3-checkbox-on': data.status == 'Y' || data.default}"></em>{{ data.name | translate }}
                        </span>
                    </div>
                </div>
                <div class="cls-daterange">
                    <span class="cls-title">{{'Conditions' | translate }}</span>
                    <span class="cls-inner-head mb-2">{{'Time' | translate}} : </span>
                    <div class="row cls-schedule-range">
                        <div class="input-field col-md-3" [ngClass]="{'cls-select-error':(submitted && scheduleForm.controls.time.errors)}">
                            <select name="time" formControlName="time" id="time">
                                <option *ngFor="let item of timeList" value="{{item.name}}">{{item.name | translate }}</option>
                            </select>
                            <label class="position-label" for="fromDate">{{'From' | translate}}<span class="cls-mandatory">*</span></label>
                        </div>
                    </div>
                    <span class="cls-inner-head mb-2">{{'Frequency date range (DOW)' | translate}} : </span>
                    <div class="row cls-schedule-range">
                        <div class="cls-date input-field col-md-3">
                            <input class="form-control date" title="Please fill out this field." type="text" id="fromDate" tabindex="0" onkeypress="return false;" autocomplete="off" formControlName="fromDate" (keydown.enter)="chooseDate('fromDate')"    (click)="chooseDate('fromDate')" 
                            [ngClass]="{'cls-border-error':(submitted && scheduleForm.controls.fromDate.errors)}" required>
                            <label class="position-label" for="fromDate">{{'From'| translate}}<span class="cls-mandatory">*</span></label>
                            <em class="icon-4-date cls-date-icon" (click)="chooseDate('fromDate')"></em>
                        </div>
                        <div class="cls-date input-field col-md-3">
                            <input class="form-control date" title="Please fill out this field." type="text" id="toDate" onkeypress="return false;" autocomplete="off" formControlName="toDate" (keydown.enter)="chooseDate('toDate')" (click)="chooseDate('toDate')"
                            [ngClass]="{'cls-border-error':(submitted && scheduleForm.controls.toDate.errors)}" required>
                            <label class="position-label" for="toDate">{{'To'|translate}}<span class="cls-mandatory">*</span></label>
                            <em class="icon-4-date cls-date-icon" (click)="chooseDate('toDate')"></em>
                        </div>
                    </div>
                </div>
                <ng-container *ngIf="rollForData.length > 0">
                    <span class="cls-codition-title mb-2">{{'Selected conditions' | translate }} :</span>
                    <div class="cls-condition-box">
                        <div class="my-3" *ngFor="let item of rollForData,let index = index">
                            <span class="cls-inner-head mb-2">{{item.key | translate}} : </span>
                            <ng-container *ngIf="item.value.startDate || item.value.departureFrom || item.value.registeredFrom || item.value.fareExpiryFrom || item.value.agentResponseFrom || item.value.requestedFrom || item.value.airlineResponseFrom || item.value.negotiationExpiryFrom || item.value.negotiationApprovedFrom || item.value.negotiationRequestFrom || item.value.issueFrom || item.value.transactionFrom || item.value.pendingDepartureFrom || item.value.paymentFrom">
                                <span class="cls-schedule-condition"><span class="cls-date cls-date-from">{{'Start date' | translate }}  </span> : <span class="cls-startData">{{item.value.startDate || item.value.registeredFrom || item.value.issueFrom || item.value.departureFrom || item.value.fareExpiryFrom || item.value.agentResponseFrom || item.value.requestedFrom || item.value.airlineResponseFrom || item.value.negotiationExpiryFrom || item.value.negotiationApprovedFrom || item.value.negotiationRequestFrom || item.value.transactionFrom || item.value.pendingDepartureFrom || item.value.paymentFrom | date: "dd-MMM-yyyy" }}</span></span> 
                                <span class="cls-schedule-condition"><span class="cls-date cls-date-to">{{'End date' | translate }}  </span> : <span class="cls-endDate">{{item.value.endDate || item.value.departureTo || item.value.registeredTo || item.value.issueTo || item.value.fareExpiryTo || item.value.agentResponseTo || item.value.requestedTo || item.value.airlineResponseTo || item.value.negotiationExpiryTo || item.value.negotiationApprovedTo || item.value.negotiationRequestTo || item.value.transactionTo || item.value.pendingDepartureTo || item.value.paymentTo | date: "dd-MMM-yyyy" }}</span> </span>
                                <span class="cls-check" tabindex="0" (keydown.enter)="clickRollForNext(item.status,index)" (click)="clickRollForNext(item.status,index)" >
                                    <span class="cls-roll">
                                    <em class="cls-icon" [ngClass]="{'icon-2-checkbox-off': item.status == 'N','icon-3-checkbox-on': item.status == 'Y' || item.default}"></em>
                                   {{'Roll for next day' | translate }}</span>
                                </span>
                            </ng-container>
                            <!-- year range selected condition values -->
                            <ng-container *ngIf="item.value.bookedYearFrom || item.value.departureYearFrom">
                                <span class="cls-schedule-condition"><span class="cls-date cls-date-from">{{'Start Year' | translate }}  </span> : <span class="cls-startData">{{item.value.bookedYearFrom || item.value.departureYearFrom}}</span></span> 
                                <span class="cls-schedule-condition"><span class="cls-date cls-date-to">{{'End Year' | translate }}  </span> : <span class="cls-endDate">{{item.value.bookedYearTo || item.value.departureYearTo}}</span> </span>
                            </ng-container>
                            <ng-container *ngIf="!item.value.startDate &&  !item.value.registeredFrom && !item.value.departureFrom && !item.value.issueFrom && !item.value.fareExpiryFrom && !item.value.agentResponseFrom && !item.value.requestedFrom && !item.value.airlineResponseFrom && !item.value.negotiationExpiryFrom && !item.value.negotiationApprovedFrom && !item.value.negotiationRequestFrom && !item.value.originCode && !item.value.transactionFrom && !item.value.pendingDepartureFrom && !item.value.paymentFrom && !item.value.bookedYearFrom && !item.value.departureYearFrom">
                                <span class="cls-auto-values">{{item.value}}</span>
                            </ng-container>
                            <ng-container *ngIf="item.value.originCode">
                                <span class="cls-schedule-condition"><span class="cls-date cls-date-from">{{ 'From'| translate}}  </span> : <span class="cls-orgin">{{item.value.originCode}}</span> </span> 
                                <span class="cls-schedule-condition"><span class="cls-date cls-date-to">{{ 'To' |translate}} </span> : <span class="cls-destination">{{item.value.destinationCode}}</span> </span> 
                            </ng-container>
                        </div>
                    </div>
                </ng-container>
            </form>
            <div class="cls-custom-btn">
                <!-- <button class="btn cls-submit">Reset</button> -->
                <button class="btn cls-submit ml-3" *ngIf="!appService?.isEditReport?.reportAdditionalInfo?.scheduleInfo?.cronInfo" (click)="createSchedule()">{{'Create' | translate }}</button>
                <button class="btn cls-submit ml-3" *ngIf="appService?.isEditReport?.reportAdditionalInfo?.scheduleInfo?.cronInfo" (click)="createSchedule()">{{'Update' | translate }}</button>
            </div>  
        </div>  
    </div>
</div>